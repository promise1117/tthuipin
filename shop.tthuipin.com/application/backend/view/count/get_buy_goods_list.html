{include file="./public/head" /} 

    <body style="overflow-y: scroll;">
        <div class="x-nav">
          <span class="layui-breadcrumb">
            <a href="/vindex">首页</a>
            <a href="">演示</a>
            <a>
              <cite>导航元素</cite></a>
          </span>
          <a class="layui-btn layui-btn-small" style="line-height:1.6em;margin-top:3px;float:right" onclick="location.reload()" title="刷新">
            <i class="layui-icon layui-icon-refresh" style="line-height:30px"></i></a>
        </div>
        <div class="layui-fluid">
            <div class="layui-row layui-col-space15">
                <div class="layui-col-md12">
                    <div class="layui-card">
                        <div class="layui-card-body ">
                            <form class="layui-form layui-col-space5">
                                <div class="layui-inline layui-show-xs-block">
                                    <input class="layui-input"  autocomplete="off" placeholder="开始日期" name="starttime" id="start">
                                </div>
                                <div class="layui-inline layui-show-xs-block">
                                    <input class="layui-input"  autocomplete="off" placeholder="结束日期" name="endtime" id="end">
                                </div>

                                <div class="layui-inline layui-show-xs-block">
                                    <div class="layui-inline">
                                        <div class="layui-input-inline">
                                            <select name="userid">
                                                <option value="">选择人员</option>
                                                {volist name="puser" id="v"}
                                                <option value="{$v.user_id}">{$v.name}</option>
                                                {volist name="cuser" id="vv"}
                                                {if $vv.pid == $v.user_id}
                                                <option value="{$vv.user_id}">|—{$vv.name}</option>
                                                {volist name="cuser" id="vvv"}
                                                {if $vvv.pid == $vv.user_id}
                                                <option value="{$vvv.user_id}">|—|—{$vvv.name}</option>
                                                {/if}
                                                {/volist}
                                                {/if}
                                                {/volist}
                                                {/volist}
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="layui-inline layui-show-xs-block">
                                    <div class="layui-inline">
                                        <div class="layui-input-inline">
                                            <select  lay-filter="timeIn">
                                                <option value="">选择日期(默认本月)</option>
                                                <option value="3">今日</option>
                                                <option value="5">昨日</option>
                                                <option value="2">最近七天</option>
                                                <option value="1">本月</option>
                                                <option value="4">上一月</option>



                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="layui-inline layui-show-xs-block">
                                    <button class="layui-btn layui-btn-danger layui-btn-lg"  lay-submit="" lay-filter="sreach"><i class="layui-icon">&#xe615;</i></button>
                                </div>
<!--                                <div class="layui-inline layui-show-xs-block">-->
<!--                                    <input type="text" name="limit"  placeholder="输入查看的条数" autocomplete="off" class="layui-input">-->
<!--                                </div>-->
                                <!--<div class="layui-inline layui-show-xs-block">-->
                                    <!--<input type="text" name="url"  placeholder="请输入路由" autocomplete="off" class="layui-input">-->
                                <!--</div>-->

                            </form>
                        </div>
                        <!--<div class="layui-card-header">-->
                            <!--&lt;!&ndash;<button class="layui-btn layui-btn-danger" onclick="delAll()"><i class="layui-icon"></i>批量删除</button>&ndash;&gt;-->
                            <!--<button class="layui-btn" onclick="xadmin.open('banenr添加','/vbanneradd',600,800)"><i class="layui-icon"></i>添加</button>-->
                        <!--</div>-->
                        <div class="layui-card-body ">
                            <table class="layui-table layui-form" lay-skin="line">
                              <thead>
                                <tr class="flow">
                                  <!--<th>-->
                                    <!--<input type="checkbox" name=""  lay-skin="primary">-->
                                  <!--</th>-->
                                  <th class="flow_col1">序号</th>
                                    <th class="flow_col2">发布者</th>
                                    <th class="name">名称</th>
                                  <th class="flow_col3">商品货号</th>

                                    <!-- 下单成功 配送中 到达代取 签收 拒收 退换货 总计-->


                                  <th style="color:green;" class="flow_col4">下单成功</th>
                                  <th style="color:purple;" class="flow_col5">配送中</th>
                                    <th style="color:darkolivegreen" class="flow_col6">清关中</th>
                                    <th style="color:darkgoldenrod" class="flow_col7">到达台湾</th>
                                  <th style="color:red;" class="flow_col8">到达代取</th>
                                  <th style="color:coral;" class="flow_col9">签收</th>
                                  <th style="color:skyblue;" class="flow_col10">拒收</th>
                                  <th style="color:#666" class="flow_col11">退换货</th>

                                  <th style="color:#2C2C2C" class="flow_col12">作废</th>
                                    <th class="flow_col13">签收率</th>
                                    <th class="flow_col14">总计</th>

                              </thead>
                              <tbody>
                              <tr>
                                  <td style="font-weight: 900;font-style: italic;">合计</td>
                                  <td></td>
                                  <td></td>
                                  <td></td>
                                  <td class="col1_total" style="font-weight: 900;font-style: italic;"></td>
                                  <td class="col2_total" style="font-weight: 900;font-style: italic;"></td>
                                  <td class="col3_total" style="font-weight: 900;font-style: italic;"></td>
                                  <td class="col4_total" style="font-weight: 900;font-style: italic;"></td>
                                  <td class="col5_total" style="font-weight: 900;font-style: italic;"></td>
                                  <td class="col6_total" style="font-weight: 900;font-style: italic;"></td>
                                  <td class="col7_total" style="font-weight: 900;font-style: italic;"></td>
                                  <td class="col8_total" style="font-weight: 900;font-style: italic;"></td>
                                  <td class="col9_total" style="font-weight: 900;font-style: italic;"></td>
                                  <td class="col9_9_total" style="font-weight: 900;font-style: italic;"></td>
                                  <td class="col10_total" style="font-weight: 900;font-style: italic;"></td>
                              </tr>
                              {php}
                              $domain = $_SERVER["REQUEST_SCHEME"].'://'.$_SERVER['SERVER_NAME'];

                              $httpUrl = preg_replace('/shop/','www',$domain,1);

                              {/php}
                              {volist name="list" id="vo"}
                                <tr>
                                  <!--<td>-->
                                    <!--<input type="checkbox" name=""  lay-skin="primary">-->
                                  <!--</td>-->
                                  <td>{$key+1}</td>
                                    <td>{$vo.username}</td>
                                    <td><img class="small_img" data-src="{$vo.img}" src="{$vo.img}"  style="width:36px;height:36px;margin-right: 30px;" /><a href="{$httpUrl}/goodsinfo?goodsid={$vo.id}" target="_blank" style="color:dodgerblue;">{$vo.name|mb_substr=0,13}...</a></td>
                                  <td>{$vo.goods_no}</td>


                                    <td style="color:red;" class="col1">{$vo.status1}</td>
                                    <td style="color:red;" class="col2">{$vo.status2}</td>
                                    <td style="color:red;" class="col3">{$vo.status7}</td>
                                    <td style="color:red;" class="col4">{$vo.status8}</td>
                                    <td style="color:red;" class="col5">{$vo.status3}</td>
                                    <td style="color:red;" class="col6">{$vo.status4}</td>
                                    <td style="color:red;" class="col7">{$vo.status5}</td>
                                    <td style="color:red;" class="col8">{$vo.status6}</td>
                                    <td style="color:red;" class="col9">{$vo.status9}</td>
                                    <td class="col9_9"></td>
                                    <td class="col10">{$vo.buynumber}</td>

                                </tr>
                              {/volist}
                              </tbody>
                            </table>
                        </div>
                        <div class="layui-card-body ">
                            <div class="page">
                                <div>
                                    {$lsit|raw}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> 
    </body>
<script src="http://libs.baidu.com/jquery/1.7.2/jquery.js"></script>
    <script>

      layui.use(['laydate','form'], function(){
        var laydate = layui.laydate;
        var form = layui.form;

        //执行一个laydate实例
        laydate.render({
          elem: '#start', //指定元素
           // value: new Date().getFullYear()+'-'+(new Date().getUTCMonth()+1)+'-01' //可任意组合
          // format: '2020年06月01日'//可任意组合
        });

        //执行一个laydate实例
        laydate.render({
          elem: '#end' //指定元
        });

          
          form.on('select(timeIn)', function(data){
              switch (data.value) {
                  case '1':
                      laydate.render({
                          elem: '#start' //指定元素
                          ,value: new Date(new Date().getFullYear() + '-' + (new Date().getMonth()+1) + '-01 00:00:00')
                      });



                      ;break;
                  case '2':
                      laydate.render({
                          elem: '#start' //指定元素
                          ,value: new Date(new Date().getTime() - 60*60*24*7*1000)
                      });


                      ;break;
                  case '3':
                      laydate.render({
                          elem: '#start' //指定元素
                          ,value: new Date(new Date().getFullYear()+'-'+(new Date().getMonth()+1)+'-'+new Date().getDate())
                      });

                      ;break;
                  case '4':
                      laydate.render({
                          elem: '#start' //指定元素
                          ,value: new Date(new Date().getFullYear() + '-' + (new Date().getMonth()) + '-01 00:00:00')
                      });

                      laydate.render({
                          elem: '#end' //指定元素
                          ,value: new Date(new Date().getFullYear() + '-' + (new Date().getMonth()+1) + '-01 00:00:00')
                      });

                      ;break;
                  case '5':
                      laydate.render({
                          elem: '#start' //指定元素
                          ,value: new Date(new Date().getFullYear()+'-'+(new Date().getMonth()+1)+'-'+(new Date().getDate()-1))
                      });

                      laydate.render({
                          elem: '#end' //指定元素
                          ,value: new Date(new Date().getFullYear()+'-'+(new Date().getMonth()+1)+'-'+new Date().getDate())
                      });

                      ;break;

              }
          });
      });

      /*用户-停用*/
      function member_stop(obj,id){
          layer.confirm('确认要停用吗？',function(index){
              if($(obj).attr('title')=='显示'){
                  $.ajax({
                      type: 'post',
                      url:"/vbannershow",
                      data:{id:id},
                      success:function(data){
                          // console.log(data);return ;
                          if(data.code = 200){
                              $(obj).attr('title','隐藏')
                              $(obj).find('i').html('&#xe62f;');

                              $(obj).parents("tr").find(".td-status").find('span').addClass('layui-btn-disabled').html('隐藏');
                              layer.msg('已隐藏!',{icon: 5,time:1000});
                          }else{
                              layer.msg('网络异常!',{icon: 5,time:1000});
                          }
                      },
                      error:function(data){
                          layer.msg('网络异常!',{icon: 5,time:1000});
                      }
                  })
                  //发异步把用户状态进行更改
              }else{
                  $.ajax({
                      url:"/vbannershow",
                      data:{id:id},
                      success:function(data){
                          if(data.code = 200){
                              $(obj).attr('title','显示')
                              $(obj).find('i').html('&#xe601;');

                              $(obj).parents("tr").find(".td-status").find('span').removeClass('layui-btn-disabled').html('显示');
                              layer.msg('已显示!',{icon: 6,time:1000});
                          }else{
                              layer.msg('网络异常!',{icon: 5,time:1000});
                          }
                      },
                      error:function(data){
                          layer.msg('网络异常!',{icon: 5,time:1000});
                      }
                  })

              }

          });
      }
      /*用户-删除*/
      function member_del(obj,id){
          layer.confirm('确认要删除吗？',function(index){
              $.ajax({
                  type:'post',
                  url:'/vbannerdelete',
                  data:{id:id},
                  success:function(data){
                      if(data.code =200){
                          //发异步删除数据
                          $(obj).parents("tr").remove();
                          layer.msg('已删除!',{icon:1,time:1000});
                      }else{
                          layer.msg('删除失败!',{icon:5,time:1000});
                      }
                  },
                  error:function (data) {
                      if(data.code = 100){
                          layer.msg(data.message,{icon:1,time:1000});
                      }
                  }
              })

          });
      }



      function delAll (argument) {

        var data = tableCheck.getData();
  
        layer.confirm('确认要删除吗？'+data,function(index){
            //捉到所有被选中的，发异步进行删除
            layer.msg('删除成功', {icon: 1});
            $(".layui-form-checked").not('.header').parents('tr').remove();
        });
      }



      // 放大图片js

      $(".small_img").click(function(){

          console.log($(this).width())
          console.log($(this).height())
          layindex = layer.open({

              type: 1,
              title: false,
              closeBtn: 0,
              shadeClose: true, //点击阴影关闭
              area: [$(this).width()*10 + 'px', $(this).height()*10 + 'px'], //宽高
              content: "<img style=\"width:100%;height: 100%;\" src=" + $(this).attr('data-src') + " />"
          });
      })



        // 固定table thead

      var toTop=$('.flow').offset().top;
      var name_width = $('.flow').find('.name').width();
      var flow_col1 = $('.flow').find('.flow_col1').width();
      var flow_col2 = $('.flow').find('.flow_col2').width();
      var flow_col3 = $('.flow').find('.flow_col3').width();
      var flow_col4 = $('.flow').find('.flow_col4').width();
      var flow_col5 = $('.flow').find('.flow_col5').width();
      var flow_col6 = $('.flow').find('.flow_col6').width();
      var flow_col7 = $('.flow').find('.flow_col7').width();
      var flow_col8 = $('.flow').find('.flow_col8').width();
      var flow_col9 = $('.flow').find('.flow_col9').width();
      var flow_col10 = $('.flow').find('.flow_col10').width();
      var flow_col11 = $('.flow').find('.flow_col11').width();
      var flow_col12 = $('.flow').find('.flow_col12').width();
      var flow_col13 = $('.flow').find('.flow_col13').width();
      var flow_col14 = $('.flow').find('.flow_col14').width();

      $(window).on('scroll', function () {

          if ($(this).scrollTop()>toTop){

              $('.flow').css({'position':'fixed','top':'0','backgroundColor':'#fff','zIndex':'100'});
              $('.flow').find('.name').width(name_width)
              $('.flow').find('.flow_col1').width(flow_col1)
              $('.flow').find('.flow_col2').width(flow_col2)
              $('.flow').find('.flow_col3').width(flow_col3)
              $('.flow').find('.flow_col4').width(flow_col4)
              $('.flow').find('.flow_col5').width(flow_col5)
              $('.flow').find('.flow_col6').width(flow_col6)
              $('.flow').find('.flow_col7').width(flow_col7)
              $('.flow').find('.flow_col8').width(flow_col8)
              $('.flow').find('.flow_col9').width(flow_col9)
              $('.flow').find('.flow_col10').width(flow_col10)
              $('.flow').find('.flow_col11').width(flow_col11)
              $('.flow').find('.flow_col12').width(flow_col12)
              $('.flow').find('.flow_col13').width(flow_col13)
              $('.flow').find('.flow_col14').width(flow_col14)

          } else{

              $('.flow').css({'position':'relative','backgroundColor':'#f1f1f1'});

          }

      })


        // col 统计
      var col1_total = 0;
      var col2_total = 0;
      var col3_total = 0;
      var col4_total = 0;
      var col5_total = 0;
      var col6_total = 0;
      var col7_total = 0;
      var col8_total = 0;
      var col9_total = 0;
      var col10_total = 0;

    $('.col1').each(function () {
        col1_total += parseInt($(this).text());
    })
    $('.col2').each(function () {
          col2_total += parseInt($(this).text());
      })
      $('.col3').each(function () {
          col3_total += parseInt($(this).text());
      })
      $('.col4').each(function () {
          col4_total += parseInt($(this).text());
      })
      $('.col5').each(function () {
          col5_total += parseInt($(this).text());
      })
      $('.col6').each(function () {
          col6_total += parseInt($(this).text());
      })
      $('.col7').each(function () {
          col7_total += parseInt($(this).text());
      })
      $('.col8').each(function () {
          col8_total += parseInt($(this).text());
      })
      $('.col9').each(function () {
          col9_total += parseInt($(this).text());
      })
      $('.col10').each(function () {
          col10_total += parseInt($(this).text());
      })
    $('.col1_total').text(col1_total);
    $('.col2_total').text(col2_total);
    $('.col3_total').text(col3_total);
    $('.col4_total').text(col4_total);
    $('.col5_total').text(col5_total);
    $('.col6_total').text(col6_total);
    $('.col7_total').text(col7_total);
    $('.col8_total').text(col8_total);
    $('.col9_total').text(col9_total);
    $('.col10_total').text(col10_total);


    // 签收率
      var receipt_rate;
      var receipt;
      var reject;
        $('.col9_9').each(function () {
            var receipt = parseInt($(this).parent().find('.col6').text());
            var reject = parseInt($(this).parent().find('.col7').text());
            if(receipt && reject){
                receipt_rate = parseInt(receipt/(receipt+reject)*100);
                $(this).text(receipt_rate+'%');
            }else{
                $(this).text('100%');
            }

        })
      $('.col9_9_total').each(function () {
          var receipt = parseInt($(this).parent().find('.col6_total').text());
          var reject = parseInt($(this).parent().find('.col7_total').text());
          if(receipt && reject){
              receipt_rate = parseInt(receipt/(receipt+reject)*100);
              $(this).text(receipt_rate+'%');
          }else{
              $(this).text('100%');
          }

      })

    </script>



</html>